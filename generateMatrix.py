import numpy as np;
import time;

x_final = ['13.136398', '12.978144', '12.9791198', '13.0665131', '13.033377', '13.0300088', '13.0994536', '12.9612736', '13.0141618', '13.0204886', '13.196697', '12.9791198', '12.9791198', '12.997803', '13.0258004', '12.978144', '12.9791198', '13.06207355', '12.9856478', '12.9791198', '12.9791198', '13.102752', '12.978144', '13.00119755', '12.96557', '12.9761768', '12.9624669', '12.978144', '12.9842156', '12.9791198', '12.9776727', '13.002285', '12.9782487', '13.4279345', '12.9791198', '12.9791198', '15.136669', '13.0521017', '12.9791198', '12.9919033', '13.0273312', '12.9791198', '12.9732913', '12.9791198', '12.978144', '13.0784743', '12.978144', '12.96771', '12.9936758', '12.9985767', '13.0137215', '13.1891552', '13.0601125', '13.0613601', '12.9791198', '13.0005089', '12.9684441', '12.9791198', '13.0117678', '12.9934976', '12.9751681', '12.964719', '12.9523031', '12.978144', '12.9726543', '12.978144', '12.94340695', '12.9736956', '12.9791198', '12.9351457', '13.0251833', '12.9791198', '13.1691901', '12.978144', '13.0120218', '12.978144', '12.9626925', '13.0077079', '13.0683625', '13.1478621', '13.102752', '13.016879', '12.9791198', '12.95634', '12.99145', '13.0152581', '12.9797454', '12.96218', '13.0331172', '12.95434485', '12.9963995', '13.1006982', '13.08913925', '12.96557', '12.9428472', '13.0386734', '12.8580811', '12.9791198', '12.8957037', '12.9401275', '12.9152208', '12.9741014', '12.9299654', '12.53290595', '12.9417261', '12.8633887', '12.96557', '12.7542986', '12.9089453', '12.79947605', '12.9224841', '12.9569966', '12.8004439', '12.8004439', '12.9680027', '12.9121916', '12.978144', '12.978144', '12.95062355', '12.9338349', '12.8857355', '12.850414', '12.8665932', '12.9401439', '12.8565317', '12.99391075', '12.7637369', '12.7883084', '12.9116225', '12.9568281', '12.8773486', '12.8773486', '12.9094922', '12.9292731', '12.9306281', '12.9229681', '12.7852528', '12.9117472', '12.9117472', '12.7712034', '12.9277134', '12.8792861', '12.9280806', '12.9340114', '12.9791198', '12.9068169', '12.8786167', '12.900591589433', '12.936265', '12.92069395', '12.9623214', '12.9528478', '12.9151131', '12.8684124', '12.790734', '12.9413253', '12.978144', '15.136669', '12.7386426', '12.93623', '12.906985', '12.900591589433', '12.978144', '12.9791198', '12.92790885', '12.9791198', '12.9149767', '12.8292522', '12.8698169', '12.978144', '12.978144', '12.928367', '12.978144', '12.962394', '12.9489339', '12.9791198', '12.897971', '13.0566493', '12.9791198', '12.9650043', '12.978144', '12.9937572', '12.965293', '12.978144', '12.978144', '12.958585', '12.9912345', '12.99557535', '13.0464616', '13.0464531', '13.0533332', '12.978144', '12.9239878', '12.9823617', '13.0601125', '13.0108677', '12.9758884', '13.0029165', '13.0163411', '13.0163411', '13.0328884', '13.0309553', '12.9546741', '13.0479497', '13.0104064', '12.978144', '12.9991087', '13.0432607', '13.0320223', '12.9791198', '12.9882338', '12.9791198', '13.01980905', '12.9931876', '12.9952296', '12.9791198', '12.9791198', '13.1905708', '13.0766407', '12.9718886', '12.9718886', '12.978144', '12.9791198', '12.9987636', '12.9791198', '12.978144', '12.799122', '12.7782588', '13.296413', '13.1331868', '12.978144', '12.978144', '12.978144', '12.8060574', '12.7426294', '12.978144', '12.9567353', '13.1715801', '13.3191113', '12.9095576', '13.0758896', '13.1767348', '12.8777098', '12.6899567', '12.8259815', '13.1440103', '12.978144', '12.9889098', '13.1043905', '12.8723657864891', '13.0592472', '12.978144', '13.3095936', '12.978144', '12.9117656', '12.764746', '12.8600866', '12.978144', '12.978144', '12.8292522', '12.978144', '12.6720709', '12.96557', '12.7898553']
y_final = ['77.603568', '77.569672', '77.5912997', '77.5966238', '77.5895227', '77.6208657', '77.5680336', '77.6152935', '77.6518539', '77.5547581', '77.7075865591887', '77.5912997', '77.5912997', '77.6041749', '77.714279', '77.569672', '77.5912997', '77.5963916436534', '77.6649767', '77.5912997', '77.5912997', '77.566548', '77.569672', '77.6881933519413', '77.60625', '77.6940765', '77.6381958', '77.569672', '77.5968864', '77.5912997', '77.7222000289312', '77.624169', '77.6401791', '77.5131493', '77.5912997', '77.5912997', '76.924184', '77.6018107', '77.5912997', '77.7162015', '77.6601508', '77.5912997', '77.6404672', '77.5912997', '77.569672', '77.6068938', '77.569672', '77.654522', '77.747265', '77.7609716', '77.6423644', '77.4184611', '77.5767725', '77.6493895', '77.5912997', '77.6753945', '77.7187843', '77.5912997', '77.6278288', '77.6924156', '77.6080598', '77.677864', '77.830108', '77.569672', '77.6036119', '77.569672', '77.6676812695692', '77.6536931', '77.5912997', '77.7047541', '77.5920609', '77.5912997', '77.5639442', '77.569672', '77.6777817', '77.569672', '77.6041603', '77.5795893', '77.584243', '77.5693207', '77.566548', '77.632936', '77.5912997', '77.748044', '77.59444', '77.617511', '77.5906167279795', '77.6635462', '77.734857', '77.6226954787814', '77.7614229', '77.5963454', '77.5827165877116', '77.60625', '77.6104155', '77.6468085', '77.5580713', '77.5912997', '77.555019', '77.5508062', '77.573598', '77.627469', '77.6006572', '77.5461906892049', '77.5755021', '77.613011205039', '77.60625', '77.4856295', '77.6239038', '77.6600240951576', '77.6953082', '77.5633682', '77.7062826', '77.7062826', '77.578642', '77.5476337', '77.569672', '77.569672', '77.5365537699925', '77.6042185137747', '77.5557448', '77.660271', '77.664727', '77.5444995', '77.5877237', '77.6490595806179', '77.655377', '77.6733345', '77.6388622', '77.8992322', '77.6028031', '77.6028031', '77.5967385573177', '77.5824229', '77.5857408', '77.5644048', '77.6380931', '77.5918492', '77.5918492', '77.6227944', '77.5514022', '77.5697529', '77.6307196872862', '77.6222304', '77.5912997', '77.5635247362134', '77.4467629', '77.4899679379624', '77.5857085578448', '77.6144210019808', '77.5057232', '77.5819643', '77.6006286', '77.590821309185', '77.737877', '77.5212118', '77.569672', '76.924184', '77.5745803', '77.517092', '77.4185281', '77.4899679379624', '77.569672', '77.5912997', '77.6179567231208', '77.5912997', '77.5609318', '77.1410902', '77.5356688', '77.569672', '77.569672', '77.5905691', '77.569672', '77.475085', '77.5968273', '77.5912997', '77.5700846', '77.5048222', '77.5912997', '77.579972', '77.569672', '77.5391325', '77.5181551', '77.569672', '77.569672', '77.535722', '77.4870119', '77.6906139460067', '77.5400676044731', '77.5483803', '77.5306036', '77.569672', '77.5204576', '77.5226376', '77.5767725', '77.5207301', '77.5644896', '77.5464264', '77.5586641823841', '77.5586641823841', '77.557374', '77.5648559396817', '77.5121724', '77.5001349', '77.5378032', '77.569672', '77.579517', '77.5125535', '77.5133377036181', '77.5912997', '77.554883', '77.5912997', '77.568892950803', '77.5753419', '77.6653532', '77.5912997', '77.5912997', '77.627882', '77.5577315', '77.5457888388713', '77.5457888388713', '77.569672', '77.5912997', '77.5482122', '77.5912997', '77.569672', '77.6806043792174', '77.7712834', '77.7258629', '77.6687093', '77.569672', '77.569672', '77.569672', '77.7862873', '77.7014816', '77.569672', '77.2242281', '77.6345704', '77.4430623', '77.386642', '77.4364795', '77.6520502', '77.7534769', '77.725314', '77.7673455', '77.6191241', '77.569672', '77.4492453', '77.6053207', '77.7618175354728', '77.4615112', '77.569672', '77.6600805', '77.569672', '77.7765251', '77.653369', '77.7861352', '77.569672', '77.569672', '77.1410902', '77.569672', '77.694284', '77.60625', '77.7514537']
x = []
y = []
place = ["A F Station Yelahanka","Agram","Air Force Hospital","Amruthahalli","Anandnagar","Arabic College","Attur","Austin Town","Banaswadi","Bangalore Bazaar","Kempegowda International Airport","Bangalore Sub Foreign Post","Bellandur","Benson Town","Bhattarahalli","Bidrahalli","BSF Campus Yelahanka","Byatarayanapura","C.V. Raman Nagar","CMM Court Complex","CMP Centre & School","CRPF Campus Yelahanka","Devanagundi","Devasandra","Doddagubbi","Doddanekkundi","Domlur","Doorvaninagar","Dr. Ambedkar Veedhi","Dr. Shivarama Karanth Nagar","EPIP","Fraser Town","G.K.V.K.","Gunjur","H.A. Farm","H.A.L. II Stage","H.K.P. Road","Hebbal Kempapura","High Court","Hoodi","Horamavu","Hulsur Bazaar","Indiranagar","ISRO Anthariksha Bhavan","J.C.Nagar","Jakkur","Jalavayuvihar","Jeevanbhimanagar","Kadugodi Extention SO","Kadugodi","Kalyananagar","Kannamangala","Kodigehalli","Kothanur","Krishnarajapuram RS","Krishnarajapuram","Kundalahalli","Legislators Home","Lingarajapuram","Mahadevapura","Mahatma Gandhi Road","Marathahalli Colony Maruthi Sevanagar","Medimallasandra","Mundur","Museum Road","Muthusandra","NAL","New Thippasandra","P&T Col. Kavalbyrasandra","Panathur","R T Nagar","R.M.V. Extension II Stage","Rajanakunte","Rajbhavan","Ramamurthy Nagar","Rameshnagar","Richmond Town","Sadashivanagar","Sahakaranagar","Singanayakanahalli","Sivan Chetty Gardens","St. Thomas Town","Training Command IAF","Vartur","Vasanthanagar","Venkateshapura","Vidhana Soudha","Vimanapura","Virgonagar","Viveknagar","Whitefield","Yelahanka","Yelahanka Satellite Town","Bangalore G.P.O.","Adugodi","Agara","Anjanapura","Ashoknagar","BSk II Stage","Banashankari III Stage","Banashankari","Bangalore Corporation Building","Bannerghatta Road","Bannerghatta","Basavanagudi","Begur","Bangalore Viswavidalaya","Bolare","Bommanahalli","Bommasandra Industrial Estate","Carmelram","Chamrajpet","Chandapura","Chandapura","Chickpet","Chikkalasandra","Chudenapura","DasarahalliSrinagar","Deepanjalinagar","Dharmaram College","Doddakallasandra","Electronics City","Gaviopuram Extension","Girinagar","Gottigere","Government Electric Factory","Haragadde","Hennagara","HSR Layout","Hulimangala","Hulimavu","Hulimavu","J P Nagar","Jayanagar","Jayanagar West","Jayangar III Block","Jigani","JP Nagar III Phase","JP Nagar VIII phase","Kallubalu","Kathriguppe","Konanakunte","Koramangala I Block","Koramangala","Koramangala VI Bk","Kumaraswamy Layout","Kumbalagodu","Kumbalgodu Gollahalli","Madhavan Park","Madivala","Mallathahalli","Mavalli","Mico Layout","Mount St Joseph","Muthanallur","Nayandahalli","Padmanabhnagar","Pampamahakavi Road","Ragihalli","Rajarajeshwarinagar","Ramohalli","Rv Niketan","Sampangiramnagar","Shanthinagar","St. Johns Medical College","State Bank Of Mysore Colony","Subramanyapura","Tavarekere","Thalaghattapura","Thataguni","Thyagarajnagar","Tilaknagar","Tyagrajnagar","Ullalu Upanagar","Wilson Garden","Wipro Limited","Yelachenahalli","Bagalgunte","Bangalore City","Bangalore Dist Offices Bldg","Bapagrama","Basaveshwaranagar","Chandra Layout","Chikkabidarkal","Gayathrinagar","Hampinagar","Herohalli","Industrial Estate","Jalahalli East","Jalahalli","Jalahalli West","K H B Colony","K. G. Road","Kamakshipalya","Kodigehalli","Laggere","Magadi Road","Mahalakshmipuram Layout","Malleswaram","Malleswaram West","Mathikere","Msrit","Nagarbhavi","Nagasandra","Nandini Layout","Nelakadiranahalli","Palace Guttahalli","Peenya Dasarahalli","Peenya I Stage","Peenya Small Industries","Rajajinagar","Rajajinagar IVth Block","Science Institute","Seshadripuram","Sri Chowdeshwari","Srirampuram","Swimming Pool Extn","Tarabanahalli","Vidyaranyapura","Vijayanagar East","Vijayanagar","Viswaneedam","Vyalikaval Extn"," West of Chord Road II stage","Yeshwanthpur Bazar","Yeswanthpura","Anekal","Attibele","Avathi","Bagalur","Bandikodigehalli","Bestamaranahalli","Bettahalsur","Bidaraguppe","Byagadadenahalli","Chamarajasagara","Magadi","Chikkajala","Chikkanahalli","Chunchanakuppe","Dasanapura","Doddajala","Dommasandra","Guddanahalli","Handenahalli","Hunasamaranahalli","Indalavadi","Kadabagere","Kannur","Kugur","Madanayakanahalli","Marsur","Mayasandra","Neralur","Neriga","Samandur","Sarjapura","Sidihoskote","Tarahunise","Tavarekere","Thammanayakanahalli","Vanakanahalli","Vidyanagara","Yadavanahalli"]
for item in x_final:
    x.append(float(item))
for item in y_final:
    y.append(float(item))
X = list(zip(x, y))
#print(X)
# from geopy.distance import distance
dist_matrix = np.array([[]])
t = []
# for i,j in zip(X, X):
#     i = tuple(i)
#     j = tuple(j)
#     t.append((distance(i, j).km))
# #dist_matrix = [list(item) for item in t]
# print(t)
import csv
from math import sin, cos, sqrt, atan2, radians
R = 6373.0
z=0
with open('distMatrix.csv', 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerow(["Source", "Destination", "Distance"])
file.close()
for i in X:
    #print(i[0])
    #print(i[1])
    z1=0
    for j in X:
        lat1 = radians(i[0])
        lon1 = radians(i[1])
        lat2 = radians(j[0])
        lon2 = radians(j[1])
        dlon = lon2 - lon1
        dlat = lat2 - lat1
        a = sin(dlat / 2)**2 + cos(lat1) * cos(lat2) * sin(dlon / 2)**2
        c = 2 * atan2(sqrt(a), sqrt(1-a))
        distance = R * c
        #print(distance)
        #t.append([place[z], place[z1], distance])
        with open('distMatrix.csv', 'a', newline='') as file:
            writer = csv.writer(file)
            writer.writerow([place[z], place[z1], distance])
        z1=z1+1
        #print(t)
        time.sleep(0.0)
        #print("Slept 0.001 seconds. I'm at:"+str(z)+" "+str(z1))
    z=z+1
file.close()
#dist_matrix = [list(item) for item in t]
#type(distance)
#print(dist_matrix)

